#!/usr/bin/env bash

set -e

. scw-ovpn-lib

cat <<EOF | help_text || exit 0
$(cmd_help revoke CLIENTNAME)
revoke the certificate for CLIENTNAME. This client will not be able to connect afterwards.
EOF

client_name="$(expect "$1" 'missing client name')"

cd "${easyrsa}"

./easyrsa revoke "${easyrsa_keys}/issued/${client_name}.crt"

systemctl reload openvpn
